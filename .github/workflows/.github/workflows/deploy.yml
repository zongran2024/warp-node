name: Deploy Warp Info Page

on:
  workflow_dispatch:
  push:
    branches: [ "main" ]
  schedule:
    - cron: '0 0 * * *'

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Generate HTML
        run: |
          cat > index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="zh">
          <head>
              <meta charset="UTF-8">
              <title>WARP 节点信息</title>
              <style>body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }</style>
          </head>
          <body>
              <h2>WARP 节点信息</h2>
              <p>此页面由 GitHub Actions 生成于 $(date)</p>
              <p>理论上此处可展示从其他可靠API获取的WARP配置信息或订阅链接。直接运行wg.sh等脚本可能存在安全风险。</p>
              <p>请考虑使用其他可靠来源的WARP配置。</p>
          </body>
          </html>
          EOF

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: .

  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    needs: build
    runs-on: ubuntu-latest
    name: Deploy
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
